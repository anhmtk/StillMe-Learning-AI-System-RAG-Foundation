{
    "version": "2.0.0",
    "tasks": [
        {
            "label": "dev:baseurl",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/compute_base_url.ps1",
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "detail": "Compute BASE_URL v√† ghi v√†o config/runtime_base_url.txt"
        },
        {
            "label": "dev:server",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/start_server.ps1",
            "group": "build",
            "dependsOn": "dev:baseurl",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "detail": "Kh·ªüi ƒë·ªông server detached v√† ch·ªù s·∫µn s√†ng"
        },
        {
            "label": "dev:wait",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/wait_ready.ps1",
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "detail": "Ch·ªù server s·∫µn s√†ng v·ªõi health check"
        },
        {
            "label": "dev:smoke",
            "type": "shell",
            "command": "powershell",
            "args": [
                "-Command",
                "$BASE_URL = Get-Content '${workspaceFolder}/config/runtime_base_url.txt'; Write-Host 'Testing BASE_URL:' $BASE_URL; try { $response = Invoke-WebRequest '$BASE_URL/version' -UseBasicParsing; Write-Host '‚úÖ /version:' $response.StatusCode; $json = $response.Content | ConvertFrom-Json; Write-Host 'Name:' $json.name 'Version:' $json.version } catch { Write-Host '‚ùå /version failed:' $_.Exception.Message; Write-Host 'üìù Server logs:'; Get-Content '${workspaceFolder}/logs/server.log' -Tail 20 }"
            ],
            "group": "test",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "detail": "Smoke test - ki·ªÉm tra /version endpoint"
        },
        {
            "label": "dev:stop",
            "type": "shell",
            "command": "${workspaceFolder}/scripts/stop_server.ps1",
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "options": {
                "cwd": "${workspaceFolder}"
            },
            "problemMatcher": [],
            "detail": "D·ª´ng server process"
        },
        {
            "label": "dev:full-pipeline",
            "dependsOrder": "sequence",
            "dependsOn": [
                "dev:baseurl",
                "dev:server",
                "dev:wait",
                "dev:smoke"
            ],
            "group": "build",
            "presentation": {
                "echo": true,
                "reveal": "always",
                "focus": false,
                "panel": "shared"
            },
            "problemMatcher": [],
            "detail": "Ch·∫°y to√†n b·ªô pipeline: baseurl ‚Üí server ‚Üí wait ‚Üí smoke"
        }
    ]
}