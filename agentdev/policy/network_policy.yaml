# AgentDev Network Policy - SEAL-GRADE
# Enterprise-grade network security configuration

rules:
  # Allowed HTTPS domains
  allow_https_google:
    domain: "*.google.com"
    protocol: https
    action: allow
    rate_limit: 60
    max_size: 10485760  # 10MB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to Google services"
    enabled: true

  allow_https_github:
    domain: "*.github.com"
    protocol: https
    action: allow
    rate_limit: 30
    max_size: 52428800  # 50MB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to GitHub"
    enabled: true

  allow_https_stackoverflow:
    domain: "*.stackoverflow.com"
    protocol: https
    action: allow
    rate_limit: 20
    max_size: 5242880  # 5MB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to Stack Overflow"
    enabled: true

  allow_https_pypi:
    domain: "*.pypi.org"
    protocol: https
    action: allow
    rate_limit: 40
    max_size: 104857600  # 100MB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to PyPI"
    enabled: true

  allow_https_npm:
    domain: "*.npmjs.org"
    protocol: https
    action: allow
    rate_limit: 40
    max_size: 104857600  # 100MB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to NPM"
    enabled: true

  allow_https_docker:
    domain: "*.docker.io"
    protocol: https
    action: allow
    rate_limit: 20
    max_size: 1048576000  # 1GB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to Docker Hub"
    enabled: true

  allow_https_aws:
    domain: "*.amazonaws.com"
    protocol: https
    action: allow
    rate_limit: 50
    max_size: 104857600  # 100MB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to AWS services"
    enabled: true

  allow_https_azure:
    domain: "*.azure.com"
    protocol: https
    action: allow
    rate_limit: 50
    max_size: 104857600  # 100MB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to Azure services"
    enabled: true

  allow_https_gcp:
    domain: "*.googleapis.com"
    protocol: https
    action: allow
    rate_limit: 50
    max_size: 104857600  # 100MB
    allowed_ports: [443]
    redirect_url: null
    description: "Allow HTTPS to Google Cloud services"
    enabled: true

  # Blocked protocols and domains
  block_http:
    domain: "*"
    protocol: http
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block all HTTP traffic (force HTTPS)"
    enabled: true

  block_ftp:
    domain: "*"
    protocol: ftp
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block all FTP traffic"
    enabled: true

  block_ssh:
    domain: "*"
    protocol: ssh
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block all SSH traffic"
    enabled: true

  # Private network blocking
  block_private_networks:
    domain: "192.168.*"
    protocol: https
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block private network access"
    enabled: true

  block_localhost:
    domain: "localhost"
    protocol: https
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block localhost access"
    enabled: true

  block_127_0_0_1:
    domain: "127.0.0.1"
    protocol: https
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block 127.0.0.1 access"
    enabled: true

  block_10_network:
    domain: "10.*"
    protocol: https
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block 10.x.x.x network"
    enabled: true

  block_172_network:
    domain: "172.16.*"
    protocol: https
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block 172.16.x.x network"
    enabled: true

  # Suspicious domains
  block_tor:
    domain: "*.onion"
    protocol: https
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block Tor domains"
    enabled: true

  block_i2p:
    domain: "*.i2p"
    protocol: https
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block I2P domains"
    enabled: true

  block_bitcoin:
    domain: "*.bit"
    protocol: https
    action: block
    rate_limit: null
    max_size: null
    allowed_ports: []
    redirect_url: null
    description: "Block Namecoin domains"
    enabled: true

  # Rate limiting for common domains
  rate_limit_common:
    domain: "*"
    protocol: https
    action: allow
    rate_limit: 10
    max_size: 1048576  # 1MB
    allowed_ports: [443]
    redirect_url: null
    description: "Default rate limit for unknown domains"
    enabled: true

# Global network settings
global_settings:
  max_concurrent_connections: 20
  default_timeout: 30
  max_redirects: 5
  user_agent: "AgentDev/1.0 (SEAL-GRADE Security)"
  tls_min_version: "1.2"
  cipher_suites: ["TLS_AES_256_GCM_SHA384", "TLS_CHACHA20_POLY1305_SHA256"]

# Security headers
security_headers:
  strict_transport_security: "max-age=31536000; includeSubDomains"
  x_content_type_options: "nosniff"
  x_frame_options: "DENY"
  x_xss_protection: "1; mode=block"
  referrer_policy: "strict-origin-when-cross-origin"

# Homoglyph protection
homoglyph_protection:
  enabled: true
  block_suspicious: true
  log_attempts: true

# IDN protection
idn_protection:
  enabled: true
  block_mixed_script: true
  block_confusing_characters: true

# Rate limiting
rate_limits:
  default_per_minute: 10
  trusted_domains_per_minute: 60
  suspicious_domains_per_minute: 1

# Audit logging
audit_logging:
  enabled: true
  log_all_requests: true
  log_blocked_requests: true
  log_rate_limited: true
  log_homoglyph_attempts: true
  retention_days: 30
