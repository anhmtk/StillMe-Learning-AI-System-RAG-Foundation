# Reflection Controller Configuration
# Cấu hình Reflection Controller

# Reflection modes with different performance characteristics
# Các chế độ phản tư với đặc tính hiệu suất khác nhau
modes:
  fast:
    max_steps: 2
    max_latency_s: 8
    tokens: 900
    description: "Fast mode for quick responses / Chế độ nhanh cho phản hồi nhanh"
  
  normal:
    max_steps: 3
    max_latency_s: 15
    tokens: 1400
    description: "Normal mode for balanced quality and speed / Chế độ bình thường cho chất lượng và tốc độ cân bằng"
  
  deep:
    max_steps: 4
    max_latency_s: 30
    tokens: 2200
    description: "Deep mode for high-quality responses / Chế độ sâu cho phản hồi chất lượng cao"

# Scoring weights for multi-objective optimization
# Trọng số chấm điểm cho tối ưu đa mục tiêu
weights:
  relevance: 0.45    # How well the response addresses the query / Mức độ phản hồi trả lời câu hỏi
  safety: 0.20       # Safety and policy compliance / An toàn và tuân thủ chính sách
  clarity: 0.15      # Clarity and readability / Độ rõ ràng và khả năng đọc
  brevity: 0.10      # Brevity and efficiency / Tính ngắn gọn và hiệu quả
  helpfulness: 0.10  # Helpfulness and actionability / Tính hữu ích và khả năng hành động

# Improvement threshold for accepting changes
# Ngưỡng cải thiện để chấp nhận thay đổi
epsilon: 0.02

# Maximum number of tool calls per response
# Số lượng tối đa tool calls mỗi phản hồi
tool_cap: 2

# Security settings
# Cài đặt bảo mật
security:
  level: "high"  # low, medium, high, critical
  blocklist:
    - "agent_dev"
    - "framework.py"
    - "modules/"
    - "internal_config"
    - "stacktrace"
    - "keys"
    - "secrets"
    - "docker-compose"
    - "uvicorn --reload"
    - "stillme_core"
    - "backup_legacy"
    - "tests/fixtures"
    - "node_modules"
    - "__pycache__"
    - "framework_memory.enc"
    - "audit.log"

# Context-aware settings
# Cài đặt nhận biết ngữ cảnh
context:
  # Intent-based reflection triggers
  # Kích hoạt phản tư dựa trên ý định
  intents:
    coding: true
    how_to: true
    explanation: true
    troubleshooting: true
    general: false
    greeting: false
  
  # Query length thresholds
  # Ngưỡng độ dài câu hỏi
  min_query_length: 20
  max_query_length: 1000
  
  # Language-specific settings
  # Cài đặt theo ngôn ngữ
  languages:
    vi:
      weights:
        clarity: 0.20  # Higher clarity weight for Vietnamese
        brevity: 0.08
    en:
      weights:
        clarity: 0.15
        brevity: 0.12

# Performance monitoring
# Giám sát hiệu suất
monitoring:
  enable_logging: true
  log_file: "logs/reflection.log"
  log_level: "INFO"
  metrics_retention_days: 30
  
  # Performance thresholds
  # Ngưỡng hiệu suất
  thresholds:
    max_avg_latency_s: 20
    min_success_rate: 0.8
    max_error_rate: 0.05

# Integration settings
# Cài đặt tích hợp
integration:
  # Hook points
  # Điểm hook
  hooks:
    app_handle_query: true
    stable_ai_inference: true
    websocket_endpoint: true
    conversational_core: true
  
  # Fallback behavior
  # Hành vi dự phòng
  fallback:
    on_error: "return_original"
    on_timeout: "return_best_so_far"
    on_security_violation: "use_policy_response"

# Development and testing
# Phát triển và kiểm thử
development:
  enable_debug_mode: false
  enable_trace_logging: false
  mock_improvements: false
  
  # Test settings
  # Cài đặt kiểm thử
  testing:
    timeout_s: 60
    max_test_iterations: 10
    enable_performance_tests: true
