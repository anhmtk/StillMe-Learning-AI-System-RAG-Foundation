# StillMe Security Best Practices Configuration
# ===========================================
# 
# Security configuration and best practices for StillMe AI Framework
# 
# Author: StillMe AI Framework Team
# Version: 1.0.0
# Last Updated: 2025-09-26

# Input Validation
input_validation:
  # Maximum input length
  max_input_length: 10000
  
  # Allowed file types for uploads
  allowed_file_types:
    - ".json"
    - ".jsonl"
    - ".txt"
    - ".md"
  
  # Maximum file size (in bytes)
  max_file_size: 10485760  # 10MB
  
  # Sanitization rules
  sanitization:
    # Remove potentially dangerous characters
    remove_patterns:
      - "<script.*?>.*?</script>"
      - "javascript:"
      - "data:"
      - "vbscript:"
    
    # Allow safe HTML tags
    allowed_html_tags:
      - "p"
      - "br"
      - "strong"
      - "em"
      - "code"
      - "pre"

# Authentication & Authorization
auth:
  # Session timeout (in seconds)
  session_timeout: 3600  # 1 hour
  
  # Maximum login attempts
  max_login_attempts: 5
  
  # Account lockout duration (in seconds)
  lockout_duration: 1800  # 30 minutes
  
  # Password requirements
  password_requirements:
    min_length: 8
    require_uppercase: true
    require_lowercase: true
    require_numbers: true
    require_special_chars: true

# Data Protection
data_protection:
  # Encryption settings
  encryption:
    algorithm: "AES-256-GCM"
    key_rotation_days: 90
  
  # PII detection and redaction
  pii_detection:
    enabled: true
    patterns:
      - "\\b\\d{3}-\\d{2}-\\d{4}\\b"  # SSN
      - "\\b\\d{4}\\s?\\d{4}\\s?\\d{4}\\s?\\d{4}\\b"  # Credit card
      - "\\b[A-Za-z0-9._%+-]+@[A-Za-z0-9.-]+\\.[A-Z|a-z]{2,}\\b"  # Email
  
  # Data retention
  retention:
    user_data_days: 365
    log_data_days: 90
    temp_data_days: 7

# API Security
api_security:
  # Rate limiting
  rate_limiting:
    requests_per_minute: 60
    requests_per_hour: 1000
    burst_limit: 10
  
  # CORS settings
  cors:
    allowed_origins:
      - "https://stillme.ai"
      - "https://app.stillme.ai"
    allowed_methods:
      - "GET"
      - "POST"
      - "PUT"
      - "DELETE"
    allowed_headers:
      - "Content-Type"
      - "Authorization"
      - "X-API-Key"
  
  # Request validation
  request_validation:
    max_request_size: 1048576  # 1MB
    timeout_seconds: 30
    require_https: true

# Logging & Monitoring
logging:
  # Security event logging
  security_events:
    enabled: true
    log_level: "INFO"
    events:
      - "authentication_failure"
      - "authorization_failure"
      - "data_access"
      - "configuration_change"
      - "security_violation"
  
  # Audit trail
  audit_trail:
    enabled: true
    retention_days: 365
    sensitive_fields:
      - "password"
      - "token"
      - "secret"
      - "key"

# Vulnerability Management
vulnerability_management:
  # Dependency scanning
  dependency_scanning:
    enabled: true
    frequency: "daily"
    tools:
      - "pip-audit"
      - "safety"
      - "bandit"
  
  # Code scanning
  code_scanning:
    enabled: true
    frequency: "on_commit"
    tools:
      - "bandit"
      - "semgrep"
      - "pylint"
  
  # Container scanning
  container_scanning:
    enabled: true
    frequency: "on_build"
    tools:
      - "trivy"
      - "clair"

# Incident Response
incident_response:
  # Automated response
  automated_response:
    enabled: true
    actions:
      - "log_incident"
      - "notify_security_team"
      - "block_suspicious_ip"
      - "rate_limit_aggressive_requests"
  
  # Escalation procedures
  escalation:
    level_1: "security_team"
    level_2: "security_manager"
    level_3: "cto"
  
  # Response time targets
  response_times:
    critical: 300  # 5 minutes
    high: 1800     # 30 minutes
    medium: 7200   # 2 hours
    low: 86400     # 24 hours

# Compliance
compliance:
  # GDPR compliance
  gdpr:
    enabled: true
    data_subject_rights:
      - "access"
      - "rectification"
      - "erasure"
      - "portability"
      - "restriction"
      - "objection"
  
  # SOC 2 compliance
  soc2:
    enabled: true
    controls:
      - "access_control"
      - "data_integrity"
      - "confidentiality"
      - "availability"
      - "processing_integrity"
  
  # ISO 27001 compliance
  iso27001:
    enabled: true
    controls:
      - "information_security_policies"
      - "organization_of_information_security"
      - "human_resource_security"
      - "asset_management"
      - "access_control"
      - "cryptography"
      - "physical_and_environmental_security"
      - "operations_security"
      - "communications_security"
      - "system_acquisition"
      - "supplier_relationships"
      - "information_security_incident_management"
      - "business_continuity"
      - "compliance"

# Security Testing
security_testing:
  # Automated security tests
  automated_tests:
    enabled: true
    frequency: "daily"
    tests:
      - "vulnerability_scan"
      - "penetration_test"
      - "security_audit"
      - "compliance_check"
  
  # Manual security testing
  manual_tests:
    enabled: true
    frequency: "monthly"
    tests:
      - "code_review"
      - "security_assessment"
      - "threat_modeling"
      - "risk_assessment"
  
  # Third-party security testing
  third_party:
    enabled: true
    frequency: "quarterly"
    providers:
      - "security_consultant"
      - "penetration_testing_firm"
      - "compliance_auditor"
